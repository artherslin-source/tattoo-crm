# ğŸš‚ Railway è³‡æ–™åº«ç¨®å­å¡«å……èªªæ˜

## âœ… è‡ªå‹•å¡«å……ï¼ˆå·²é…ç½®ï¼‰

å¾Œç«¯æœå‹™åœ¨ Railway éƒ¨ç½²æ™‚æœƒ**è‡ªå‹•åŸ·è¡Œ**ä»¥ä¸‹æ“ä½œï¼š

1. ç”Ÿæˆ Prisma Client
2. æ¨é€è³‡æ–™åº«çµæ§‹åˆ° PostgreSQL (`npx prisma db push`)
3. **è‡ªå‹•å¡«å……æ¸¬è©¦æ•¸æ“š** (`npx ts-node prisma/seed.ts`)
4. å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼

é€™äº›æ“ä½œå·²é…ç½®åœ¨ `backend/package.json` çš„ `start:prod` è…³æœ¬ä¸­ã€‚

---

## ğŸ“Š è‡ªå‹•å‰µå»ºçš„æ¸¬è©¦å¸³è™Ÿ

### ç®¡ç†å“¡å¸³è™Ÿ (BOSS)
- **å¸³è™Ÿ**: `admin@test.com`
- **å¯†ç¢¼**: `12345678`
- **æ¬Šé™**: æœ€é«˜æ¬Šé™

### åˆ†åº—ç¶“ç†
- **å¸³è™Ÿ**: `manager1@test.com`, `manager2@test.com`
- **å¯†ç¢¼**: `12345678`

### åˆºé’å¸«
- **å¸³è™Ÿ**: `artist1@test.com`, `artist2@test.com`, `artist3@test.com`
- **å¯†ç¢¼**: `12345678`

### æœƒå“¡
- **å¸³è™Ÿ**: `member1@test.com` ~ `member12@test.com`
- **å¯†ç¢¼**: `12345678`

---

## ğŸ“ ç¨®å­æ•¸æ“šå…§å®¹

è‡ªå‹•å¡«å……çš„æ•¸æ“šåŒ…æ‹¬ï¼š

âœ… **2 å€‹åˆ†åº—**
- ä¸‰é‡åº—
- æ±æ¸¯åº—

âœ… **3 å€‹åˆºé’å¸«**
- é™³éœ‡å®‡ï¼ˆæ±æ¸¯åº—ï¼‰
- é»ƒæ™¨æ´‹ï¼ˆä¸‰é‡åº—ï¼‰
- æ—æ‰¿è‘‰ï¼ˆä¸‰é‡åº—ï¼‰

âœ… **10 å€‹æœå‹™é …ç›®**
- å°åœ–æ¡ˆåˆºé’ã€åŠè‡‚åˆºé’ã€å…¨è‡‚åˆºé’ç­‰

âœ… **12 å€‹æœƒå“¡**
- åŒ…å«æœƒå“¡ç­‰ç´šå’Œé¤˜é¡è³‡æ–™

âœ… **24 å€‹é ç´„**
- æ¯ä½åˆºé’å¸« 8 å€‹é ç´„
- éƒ¨åˆ†å·²å®Œæˆä¸¦ç”Ÿæˆè¨‚å–®

âœ… **15 å€‹è¨‚å–®**
- åŒ…å«å¾…çµå¸³å’Œå·²çµå¸³ç‹€æ…‹
- éƒ¨åˆ†è¨‚å–®æœ‰åˆ†æœŸä»˜æ¬¾è¨˜éŒ„

---

## ğŸ”„ é‡æ–°å¡«å……æ•¸æ“šï¼ˆå¦‚éœ€è¦ï¼‰

å¦‚æœéœ€è¦é‡ç½® Railway è³‡æ–™åº«ä¸¦é‡æ–°å¡«å……æ•¸æ“šï¼š

### æ–¹æ³• 1: é€é Railway Dashboard

1. é€²å…¥ Railway Dashboard
2. é¸æ“‡å¾Œç«¯æœå‹™ (Backend Service)
3. é»æ“Šå³ä¸Šè§’çš„ä¸‰å€‹é» (...) > Restart
4. ç³»çµ±æœƒè‡ªå‹•åŸ·è¡Œ `start:prod` è…³æœ¬ï¼ŒåŒ…å«ç¨®å­å¡«å……

### æ–¹æ³• 2: é‡æ–°éƒ¨ç½²

1. æ¨é€ä»»ä½•è®Šæ›´åˆ° GitHub
   ```bash
   git commit --allow-empty -m "trigger redeploy"
   git push origin main
   ```
2. Railway æœƒè‡ªå‹•é‡æ–°éƒ¨ç½²ä¸¦å¡«å……æ•¸æ“š

### æ–¹æ³• 3: æ‰‹å‹•åŸ·è¡Œï¼ˆéœ€è¦ Railway CLIï¼‰

```bash
# é€£æ¥åˆ° Railway æœå‹™
railway link

# åŸ·è¡Œç¨®å­è…³æœ¬
railway run npm run seed
```

---

## âš ï¸ æ³¨æ„äº‹é …

### æœ¬åœ°é–‹ç™¼ vs Railway

**æœ¬åœ°é–‹ç™¼ï¼ˆSQLiteï¼‰**:
- `backend/prisma/schema.prisma`: `provider = "sqlite"`
- `backend/.env`: `DATABASE_URL="file:./prisma/dev.db"`
- æ‰‹å‹•åŸ·è¡Œ: `npx ts-node prisma/seed.ts`

**Railway ç”Ÿç”¢ç’°å¢ƒï¼ˆPostgreSQLï¼‰**:
- `backend/prisma/schema.prisma`: `provider = "postgresql"`
- Railway ç’°å¢ƒè®Šæ•¸: `DATABASE_URL=postgresql://...`
- è‡ªå‹•åŸ·è¡Œ: åŒ…å«åœ¨ `start:prod` è…³æœ¬ä¸­

### é¿å…æ•¸æ“šä¸Ÿå¤±

âš ï¸ **è­¦å‘Š**: `npx prisma db push --accept-data-loss` æœƒé‡ç½®è³‡æ–™åº«ï¼

å¦‚æœ Railway è³‡æ–™åº«å·²æœ‰é‡è¦æ•¸æ“šï¼š
1. **ä¸è¦**é‡æ–°éƒ¨ç½²å¾Œç«¯
2. æ”¹ç”¨ Prisma Migrate: `npx prisma migrate deploy`
3. æ‰‹å‹•åŸ·è¡Œç¨®å­è…³æœ¬ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œ 1: "User not found" ç™»å…¥éŒ¯èª¤

**å¯èƒ½åŸå› **: 
- Railway PostgreSQL è³‡æ–™åº«ç‚ºç©º
- ç¨®å­è…³æœ¬åŸ·è¡Œå¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**:
1. æª¢æŸ¥ Railway éƒ¨ç½²æ—¥èªŒï¼Œç¢ºèªç¨®å­è…³æœ¬æ˜¯å¦æˆåŠŸåŸ·è¡Œ
2. æŸ¥æ‰¾æ—¥èªŒä¸­çš„ `ğŸ‰ Seeding å®Œæˆï¼` è¨Šæ¯
3. å¦‚æœæ²’æœ‰çœ‹åˆ°ï¼Œè§¸ç™¼é‡æ–°éƒ¨ç½²

### å•é¡Œ 2: ç¨®å­è…³æœ¬åŸ·è¡Œå¤±æ•—

**å¯èƒ½åŸå› **:
- `ts-node` æœªå®‰è£
- è³‡æ–™åº«é€£æ¥å¤±æ•—
- schema å’Œè³‡æ–™åº«ä¸åŒæ­¥

**è§£æ±ºæ–¹æ¡ˆ**:
1. ç¢ºèª `ts-node` åœ¨ `dependencies` ä¸­ï¼ˆå·²é…ç½®ï¼‰
2. ç¢ºèª Railway `DATABASE_URL` ç’°å¢ƒè®Šæ•¸æ­£ç¢º
3. æª¢æŸ¥éƒ¨ç½²æ—¥èªŒçš„è©³ç´°éŒ¯èª¤è¨Šæ¯

### å•é¡Œ 3: è³‡æ–™é‡è¤‡éŒ¯èª¤

**ç—‡ç‹€**: `Unique constraint failed on the fields: (email)`

**åŸå› **: è³‡æ–™åº«å·²æœ‰ç›¸åŒ email çš„ç”¨æˆ¶

**è§£æ±ºæ–¹æ¡ˆ**: 
ç¨®å­è…³æœ¬æœƒè‡ªå‹•æ¸…ç†èˆŠæ•¸æ“šï¼Œä½†å¦‚æœå¤±æ•—ï¼š
1. åœ¨ Railway Dashboard åˆªé™¤ä¸¦é‡æ–°å‰µå»º PostgreSQL æœå‹™
2. è§¸ç™¼å¾Œç«¯é‡æ–°éƒ¨ç½²

---

## ğŸ“‹ éƒ¨ç½²æª¢æŸ¥æ¸…å–®

éƒ¨ç½²åˆ° Railway å‰ï¼Œç¢ºèªï¼š

- âœ… `backend/prisma/schema.prisma` ä½¿ç”¨ `postgresql`
- âœ… `backend/package.json` åŒ…å«ç¨®å­è…³æœ¬åœ¨ `start:prod`
- âœ… `ts-node` åœ¨ `dependencies` ä¸­
- âœ… Railway ç’°å¢ƒè®Šæ•¸ `DATABASE_URL` å·²è¨­ç½®
- âœ… Railway ç’°å¢ƒè®Šæ•¸ `JWT_ACCESS_SECRET` å·²è¨­ç½®
- âœ… Railway ç’°å¢ƒè®Šæ•¸ `JWT_REFRESH_SECRET` å·²è¨­ç½®

éƒ¨ç½²å¾Œé©—è­‰ï¼š

- âœ… æª¢æŸ¥éƒ¨ç½²æ—¥èªŒä¸­çš„ `ğŸ‰ Seeding å®Œæˆï¼`
- âœ… ä½¿ç”¨ `admin@test.com` / `12345678` ç™»å…¥
- âœ… æª¢æŸ¥é¦–é æ˜¯å¦é¡¯ç¤ºæœå‹™å’Œåˆºé’å¸«

---

**æœ€å¾Œæ›´æ–°**: 2025-10-09

