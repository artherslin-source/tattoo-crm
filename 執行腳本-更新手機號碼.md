# 📱 更新管理員和刺青師手機號碼 - 主控台執行指南

## 🚀 快速執行（推薦）

### 步驟 1：打開瀏覽器主控台

1. 打開瀏覽器（Chrome、Firefox、Edge 等）
2. 按 `F12` 或右鍵點擊頁面 → 選擇「檢查」
3. 切換到 **Console（主控台）** 標籤

### 步驟 2：執行腳本

**請先修改後端網址！** 將以下代碼中的 `YOUR_BACKEND_URL` 替換為您的實際後端網址（例如：`https://your-backend.railway.app`）

```javascript
// ========== 後端 URL 配置 ==========
// 後端服務網址：https://tattoo-crm-production-413f.up.railway.app
// 前端服務網址：https://tattoo-crm-production.up.railway.app
const BACKEND_URL = 'https://tattoo-crm-production-413f.up.railway.app';
const SECRET = 'temporary-init-secret-2024';

console.log('🔍 後端 URL:', BACKEND_URL);
console.log('📱 前端 URL:', window.location.origin);
console.log('');

async function fixAdminArtistPhones() {
  try {
    console.log('🔧 開始更新管理員和刺青師的手機號碼...\n');
    
      // 構建完整的 API URL
      const apiUrl = `${BACKEND_URL}/auth/fix-admin-artist-phones`;
      
      console.log('📡 請求 URL:', apiUrl);
    
    const response = await fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        secret: SECRET
      })
    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.message || `HTTP ${response.status}`);
    }

    const data = await response.json();
    
    console.log('✅ 執行成功！\n');
    console.log('📋 更新結果：');
    console.log('BOSS:', data.results.boss);
    console.log('分店經理:', data.results.managers);
    console.log('刺青師:', data.results.artists);
    
    if (data.results.errors && data.results.errors.length > 0) {
      console.warn('\n⚠️  警告：');
      data.results.errors.forEach((error, index) => {
        console.warn(`${index + 1}. ${error}`);
      });
    }
    
    console.log('\n📋 帳號列表：');
    console.table(data.accountList);
    console.log('\n🔑 預設密碼：', data.defaultPassword);
    
    return data;
  } catch (error) {
    console.error('❌ 執行失敗:', error);
    console.error('錯誤詳情:', error.message);
    throw error;
  }
}

// 執行函數
fixAdminArtistPhones();
```

### 步驟 3：查看結果

執行後，主控台會顯示：
- ✅ 更新成功的帳號
- ⚠️ 警告訊息（如果有）
- 📋 完整的帳號列表表格
- 🔑 預設密碼

---

## 📋 帳號列表（更新後）

| 角色 | 姓名 | 手機號碼 | 密碼 |
|------|------|---------|------|
| BOSS | Super Admin | **0988666888** | 12345678 |
| BRANCH_MANAGER | 三重店經理 | **0911111111** | 12345678 |
| BRANCH_MANAGER | 東港店經理 | **0922222222** | 12345678 |
| ARTIST | 陳震宇 | **0933333333** | 12345678 |
| ARTIST | 黃晨洋 | **0944444444** | 12345678 |
| ARTIST | 林承葉 | **0955555555** | 12345678 |

---

## 🔧 其他執行方式

### 方式二：使用 curl（終端機）

```bash
curl -X POST https://your-backend.railway.app/auth/fix-admin-artist-phones \
  -H "Content-Type: application/json" \
  -d '{"secret":"temporary-init-secret-2024"}'
```

### 方式三：使用 Postman

1. 方法：`POST`
2. URL：`https://your-backend.railway.app/auth/fix-admin-artist-phones`
3. Headers：`Content-Type: application/json`
4. Body (raw JSON)：
```json
{
  "secret": "temporary-init-secret-2024"
}
```

---

## ⚠️ 注意事項

1. **後端網址**：請確保使用正確的後端網址（不是前端網址）
2. **Secret 保護**：預設 secret 為 `temporary-init-secret-2024`，如需更改請在環境變數中設置 `BOSS_INIT_SECRET`
3. **手機號碼衝突**：如果目標手機號碼已被其他用戶使用，該帳號會被跳過並顯示警告
4. **執行後**：更新完成後，可以使用新的手機號碼登入系統

---

## 🎯 執行後續操作

更新完成後，管理員和刺青師可以：

1. **使用新手機號碼登入**：使用更新後的手機號碼和預設密碼 `12345678` 登入
2. **自行更換手機號碼**：
   - 登入後進入個人資料頁面（`/profile`）
   - 點擊「編輯」按鈕
   - 修改手機號碼（系統會驗證格式和唯一性）
   - 點擊「儲存」

---

## ❓ 常見問題

**Q: 執行後顯示 "Invalid secret" 錯誤？**  
A: 請確認 secret 參數正確，或檢查環境變數 `BOSS_INIT_SECRET` 是否已設置。

**Q: 某些帳號顯示 "跳過更新"？**  
A: 這表示目標手機號碼已被其他用戶使用，需要先處理衝突。

**Q: 找不到某些帳號？**  
A: 請確認資料庫中是否存在對應的帳號（BOSS、分店經理、刺青師）。

